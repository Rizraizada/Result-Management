(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[967],{4950:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/student/add-student",function(){return t(6554)}])},6554:function(e,s,t){"use strict";t.r(s);var r=t(5893),a=t(7294),l=t(1163),d=t(2497),n=t(7730);s.default=()=>{let[e,s]=(0,a.useState)({user_id:"",section_id:"",name:"",phone:"",address:"",position:"",email:"",gender:"",expertise:"",image:null}),[t,i]=(0,a.useState)(null),[o,c]=(0,a.useState)(null),[m,u]=(0,a.useState)(!1),h=(0,l.useRouter)(),{user:x}=(0,a.useContext)(n.S),[g,p]=(0,a.useState)([]),[j,f]=(0,a.useState)([]);(0,a.useEffect)(()=>{x?"headmaster"!==x.role&&"teacher"!==x.role&&h.push("/unauthorized"):h.push("/login")},[x,h]),(0,a.useEffect)(()=>{let e=async()=>{try{let e=await fetch("".concat(d.Z,"/api/sections")),s=await e.json();e.ok?f(s):c({type:"error",text:"Failed to fetch sections"})}catch(e){console.log("Error fetching sections:",e),c({type:"error",text:e.message})}};(async()=>{try{let e=await fetch("".concat(d.Z,"/api/auth/users")),s=await e.json();e.ok?p(s.users):c({type:"error",text:"Failed to fetch users"})}catch(e){c({type:"error",text:e.message})}})(),e()},[]);let b=e=>{let{name:t,value:r}=e.target;s(e=>({...e,[t]:r}))},y=async s=>{s.preventDefault(),u(!0);try{let s=new FormData;Object.keys(e).forEach(t=>{null!==e[t]&&""!==e[t]&&s.append(t,e[t])});let t=await fetch("".concat(d.Z,"/api/students/students"),{method:"POST",body:s}),r=await t.json();if(t.ok)c({type:"success",text:"Student added successfully"}),setTimeout(()=>{h.push("/admin/student/student-list")},1500);else throw Error(r.message||"Failed to save Student")}catch(e){console.error("Error saving Student:",e),c({type:"error",text:e.message||"Failed to save Student"})}finally{u(!1)}};return x?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[o&&(0,r.jsx)("div",{className:"mb-6 p-4 rounded-lg shadow-sm ".concat("error"===o.type?"bg-red-50 text-red-700 border border-red-200":"bg-green-50 text-green-700 border border-green-200"),children:o.text}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl overflow-hidden shadow-lg",children:[(0,r.jsxs)("div",{className:"px-6 py-8 bg-gradient-to-r from-blue-600 to-gray-700",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-white",children:"Add New Student"}),(0,r.jsx)("p",{className:"mt-2 text-blue-100",children:"Create a new Student profile"})]}),(0,r.jsxs)("form",{onSubmit:y,className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"user_id",className:"text-sm font-medium text-gray-700",children:"Assign Teacher"}),(0,r.jsxs)("select",{id:"user_id",name:"user_id",value:e.user_id,onChange:b,className:"mt-2 w-full p-3 border border-gray-300 rounded-lg",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select Teacher"}),g.length>0?g.map(e=>(0,r.jsx)("option",{value:e.id,children:e.full_name},e.id)):(0,r.jsx)("option",{children:"Loading..."})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"section_id",className:"text-sm font-medium text-gray-700",children:"Section"}),(0,r.jsxs)("select",{id:"section_id",name:"section_id",value:e.section_id,onChange:b,className:"mt-2 w-full p-3 border border-gray-300 rounded-lg",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select Section"}),j.length>0?j.map(e=>(0,r.jsx)("option",{value:e.id,children:e.sectionName},e.id)):(0,r.jsx)("option",{children:"No sections available"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"text-sm font-medium text-gray-700",children:"Name"}),(0,r.jsx)("input",{type:"text",id:"name",name:"name",value:e.name,onChange:b,className:"mt-2 w-full p-3 border border-gray-300 rounded-lg",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"text-sm font-medium text-gray-700",children:"Email"}),(0,r.jsx)("input",{type:"email",id:"email",name:"email",value:e.email,onChange:b,className:"mt-2 w-full p-3 border border-gray-300 rounded-lg",required:!0})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"phone",className:"text-sm font-medium text-gray-700",children:"Phone"}),(0,r.jsx)("input",{type:"text",id:"phone",name:"phone",value:e.phone,onChange:b,className:"mt-2 w-full p-3 border border-gray-300 rounded-lg",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"position",className:"text-sm font-medium text-gray-700",children:"Father Name"}),(0,r.jsx)("input",{type:"text",id:"position",name:"position",value:e.position,onChange:b,className:"mt-2 w-full p-3 border border-gray-300 rounded-lg",required:!0})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"expertise",className:"text-sm font-medium text-gray-700",children:"Mother Name"}),(0,r.jsx)("input",{type:"text",id:"expertise",name:"expertise",value:e.expertise,onChange:b,className:"mt-2 w-full p-3 border border-gray-300 rounded-lg"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"gender",className:"text-sm font-medium text-gray-700",children:"Gender"}),(0,r.jsxs)("select",{id:"gender",name:"gender",value:e.gender,onChange:b,className:"mt-2 w-full p-3 border border-gray-300 rounded-lg",children:[(0,r.jsx)("option",{value:"",children:"Select Gender"}),(0,r.jsx)("option",{value:"male",children:"Male"}),(0,r.jsx)("option",{value:"female",children:"Female"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"address",className:"text-sm font-medium text-gray-700",children:"Address"}),(0,r.jsx)("textarea",{id:"address",name:"address",value:e.address,onChange:b,className:"mt-2 w-full p-3 border border-gray-300 rounded-lg",rows:"3"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Profile Picture"}),(0,r.jsxs)("label",{className:"w-full max-w-sm h-52 border-2 border-dashed border-gray-300 rounded-md cursor-pointer flex items-center justify-center transition-colors hover:border-gray-400",children:[(0,r.jsxs)("div",{className:"text-center text-gray-400",children:[(0,r.jsx)("svg",{className:"w-8 h-8 mx-auto",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,r.jsx)("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4m4-5l5-5 5 5m-5-5v12"})}),(0,r.jsx)("span",{children:"Click to upload image"})]}),(0,r.jsx)("input",{type:"file",className:"hidden",onChange:e=>{let t=e.target.files[0];if(t){if(t.size>5242880){c({type:"error",text:"Image size should be less than 5MB"});return}s(e=>({...e,image:t})),i(URL.createObjectURL(t))}},accept:"image/*"})]}),t&&(0,r.jsx)("div",{className:"w-full max-w-sm rounded-md overflow-hidden",children:(0,r.jsx)("img",{src:t,alt:"Preview",className:"w-full h-52 object-cover"})})]}),(0,r.jsx)("button",{type:"submit",disabled:m,className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg",children:m?"Adding...":"Add Student"})]})]})]})}):null}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=4950)}),_N_E=e.O()}]);