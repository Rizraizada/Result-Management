(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[847],{5584:function(e,l,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/student/Excel-Entry",function(){return t(8822)}])},8822:function(e,l,t){"use strict";t.r(l);var s=t(5893),a=t(7294),n=t(1163),i=t(2497),o=t(7730),r=t(6455),c=t.n(r);l.default=()=>{let[e,l]=(0,a.useState)(null),[t,r]=(0,a.useState)(null),[u,d]=(0,a.useState)(!1),m=(0,n.useRouter)(),{user:x}=(0,a.useContext)(o.S);(0,a.useEffect)(()=>{x?"headmaster"!==x.role&&"teacher"!==x.role&&m.push("/unauthorized"):m.push("/login")},[x,m]);let f=e=>{"excelFile"===e.target.name?l(e.target.files[0]):r(e.target.files[0])},h=async l=>{if(l.preventDefault(),!e&&!t){c().fire({icon:"error",title:"Oops...",text:"Please upload an Excel file or an image."});return}d(!0);let s=new FormData;t&&s.append("image",t),e&&s.append("excelFile",e);try{let e=await fetch("".concat(i.Z,"/api/students/students/excel"),{method:"POST",body:s});if(!e.ok)throw Error("Failed to upload file");let l=await e.json();c().fire({icon:"success",title:"Success!",text:l.message})}catch(e){c().fire({icon:"error",title:"Error",text:e.message})}finally{d(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl overflow-hidden shadow-lg",children:[(0,s.jsxs)("div",{className:"px-6 py-8 bg-gradient-to-r from-blue-600 to-blue-700",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold text-white",children:"Upload Image or Excel File"}),(0,s.jsx)("p",{className:"mt-2 text-blue-100",children:"Upload an Excel file to add multiple students or an image"})]}),(0,s.jsxs)("form",{onSubmit:h,className:"p-6 space-y-6 bg-white shadow-md rounded-lg",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{htmlFor:"excelFile",className:"text-sm font-medium text-gray-700",children:"Excel File"}),(0,s.jsx)("input",{type:"file",id:"excelFile",name:"excelFile",accept:".xlsx,.xls",onChange:f,className:"mt-2 w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{htmlFor:"image",className:"text-sm font-medium text-gray-700",children:"Image File (optional)"}),(0,s.jsx)("input",{type:"file",id:"image",name:"image",accept:"image/*",onChange:f,className:"mt-2 w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsx)("button",{type:"submit",disabled:u,className:"mt-4 w-full py-2 px-4 rounded-md ".concat(u?"bg-gray-400":"bg-blue-600 hover:bg-blue-700"," text-white focus:outline-none focus:ring-2 focus:ring-blue-500"),children:u?"Uploading...":"Upload Students"})]})]})})})}}},function(e){e.O(0,[166,888,774,179],function(){return e(e.s=5584)}),_N_E=e.O()}]);