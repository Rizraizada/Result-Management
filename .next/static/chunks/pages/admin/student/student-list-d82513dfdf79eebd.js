(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[269],{9833:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/student/student-list",function(){return s(9335)}])},9335:function(e,t,s){"use strict";s.r(t);var a=s(5893),r=s(7294),l=s(1163),n=s(2497),d=s(7730);t.default=()=>{let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)([]),[o,c]=(0,r.useState)(null),[h,u]=(0,r.useState)(!0),[m,x]=(0,r.useState)(""),[p,b]=(0,r.useState)(1),[g]=(0,r.useState)(5),j=(0,l.useRouter)(),{user:N}=(0,r.useContext)(d.S);(0,r.useEffect)(()=>{N?"headmaster"!==N.role&&"teacher"!==N.role?j.push("/unauthorized"):f():j.push("/login")},[N,j]);let f=async()=>{try{u(!0);let e=await fetch("".concat(n.Z,"/api/students/students")),s=await e.json();if(e.ok){let e=(Array.isArray(s)?s:s.students||[]).map(e=>({...e,id:e._id||e.id}));t(e),i(e)}else c({type:"error",text:s.message||"Failed to fetch students"})}catch(e){console.error("Error fetching students:",e),c({type:"error",text:"Failed to fetch students"})}finally{u(!1)}},w=e=>{j.push("/admin/students/TeacherLis?id=".concat(e))},y=async e=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{let t=await fetch("".concat(n.Z,"/api/students/students/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"}});if(t.ok)c({type:"success",text:"Teacher deleted successfully"}),f();else{let e=await t.json();c({type:"error",text:e.message||"Failed to delete teacher"})}}catch(e){console.error("Error deleting teacher:",e),c({type:"error",text:"Failed to delete teacher"})}},v=p*g,C=v-g,E=s.slice(C,v),k=Math.ceil(s.length/g),_=e=>{e>=1&&e<=k&&b(e)};return N?(0,a.jsxs)("div",{className:"max-w-[1200px] mx-auto mt-8 px-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)("button",{onClick:()=>{j.push("/admin/teacher/add-teacher")},className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition",children:"Add New Teacher"}),(0,a.jsx)("input",{type:"text",placeholder:"Search students...",value:m,onChange:t=>{x(t.target.value),i(e.filter(e=>e.name.toLowerCase().includes(t.target.value.toLowerCase())||e.email.toLowerCase().includes(t.target.value.toLowerCase()))),b(1)},className:"p-2 rounded-md border border-gray-300"})]}),o&&(0,a.jsx)("div",{className:"p-4 rounded-md mb-4 cursor-pointer ".concat("error"===o.type?"bg-red-100 text-red-700 border border-red-200":"bg-green-100 text-green-700 border border-green-200"),onClick:()=>c(null),children:o.text}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:h?(0,a.jsx)("div",{className:"text-center py-8 text-gray-600",children:"Loading..."}):(0,a.jsxs)("table",{className:"min-w-full text-sm table-auto",children:[(0,a.jsx)("thead",{className:"bg-gray-100 text-left",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-4",children:"Profile"}),(0,a.jsx)("th",{className:"p-4",children:"Name"}),(0,a.jsx)("th",{className:"p-4",children:"Email"}),(0,a.jsx)("th",{className:"p-4",children:"Position"}),(0,a.jsx)("th",{className:"p-4",children:"Phone"}),(0,a.jsx)("th",{className:"p-4",children:"Gender"}),(0,a.jsx)("th",{className:"p-4",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:E.length>0?E.map(e=>(0,a.jsxs)("tr",{className:"border-t hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-300 flex items-center justify-center",children:e.image?(0,a.jsx)("img",{src:"".concat(n.Z,"/").concat(e.image),alt:e.name,className:"object-cover w-full h-full",onError:e=>{e.target.onerror=null,e.target.src=""}}):(0,a.jsx)("span",{className:"text-white font-bold text-lg",children:e.name.charAt(0).toUpperCase()})})}),(0,a.jsx)("td",{className:"p-4",children:e.name}),(0,a.jsx)("td",{className:"p-4",children:e.email}),(0,a.jsx)("td",{className:"p-4",children:e.position}),(0,a.jsx)("td",{className:"p-4",children:e.phone}),(0,a.jsx)("td",{className:"p-4 capitalize",children:e.gender}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>w(e.id),className:"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>y(e.id),className:"px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 transition",children:"Delete"})]})})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"7",className:"p-4 text-center text-gray-600",children:"No students available"})})})]})}),(0,a.jsxs)("div",{className:"flex justify-between items-center px-4 py-3 mt-4",children:[(0,a.jsxs)("div",{className:"text-sm text-slate-500",children:["Showing ",(0,a.jsxs)("b",{children:[C+1,"-",Math.min(v,s.length)]})," of"," ",s.length]}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("button",{onClick:()=>_(p-1),disabled:1===p,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal text-slate-500 bg-white border border-slate-200 rounded hover:bg-slate-50 hover:border-slate-400 transition duration-200 ease disabled:opacity-50 disabled:cursor-not-allowed",children:"Prev"}),Array.from({length:k},(e,t)=>(0,a.jsx)("button",{onClick:()=>_(t+1),className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal ".concat(p===t+1?"text-white bg-slate-800 border-slate-800 hover:bg-slate-600 hover:border-slate-600":"text-slate-500 bg-white border-slate-200 hover:bg-slate-50 hover:border-slate-400"," rounded transition duration-200 ease"),children:t+1},t)),(0,a.jsx)("button",{onClick:()=>_(p+1),disabled:p>=k,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal text-slate-500 bg-white border border-slate-200 rounded hover:bg-slate-50 hover:border-slate-400 transition duration-200 ease disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}):null}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=9833)}),_N_E=e.O()}]);