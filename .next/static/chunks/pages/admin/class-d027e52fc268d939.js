(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[213],{9989:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/class",function(){return s(9474)}])},9474:function(e,t,s){"use strict";s.r(t);var a=s(5893),r=s(7294),l=s(2497),o=s(6455),c=s.n(o),n=s(7730),i=s(1163);t.default=()=>{let[e,t]=(0,r.useState)(""),[s,o]=(0,r.useState)([]),[d,u]=(0,r.useState)(!0),[h,m]=(0,r.useState)(""),[p,x]=(0,r.useState)(!1),[f,g]=(0,r.useState)(null),{user:b}=(0,r.useContext)(n.S),w=(0,i.useRouter)();(0,r.useEffect)(()=>{b?"headmaster"!==b.role&&w.push("/unauthorized"):w.push("/login")},[b,w]),(0,r.useEffect)(()=>{b&&"headmaster"===b.role&&y()},[b]);let y=async()=>{u(!0);try{let e=await fetch("".concat(l.Z,"/api/classes"),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(!e.ok){let t=await e.text();throw Error(t||"Failed to fetch classes")}let t=await e.json();o(t),u(!1)}catch(e){m(e.message||"Error fetching classes"),u(!1),c().fire({icon:"error",title:"Fetch Error",text:e.message})}},N=async s=>{if(s.preventDefault(),!e.trim()){c().fire({icon:"warning",title:"Class Name Required",text:"Please enter a class name."});return}try{let s=await fetch("".concat(l.Z,"/api/classes"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({className:e.trim()})});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to create class")}c().fire({icon:"success",title:"Class Created",text:"The class was created successfully!"}),y(),t("")}catch(e){c().fire({icon:"error",title:"Error Creating Class",text:e.message||"An unknown error occurred."})}},C=(e,s)=>{g(e),t(s),x(!0)},j=async s=>{if(s.preventDefault(),!e.trim()){c().fire({icon:"warning",title:"Class Name Required",text:"Please enter a class name before updating."});return}try{let s=await fetch("".concat(l.Z,"/api/classes/").concat(f),{method:"PUT",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({className:e.trim()})});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to update class")}c().fire({icon:"success",title:"Class Updated",text:"The class was updated successfully!"}),y(),t(""),x(!1),g(null)}catch(e){c().fire({icon:"error",title:"Error Updating Class",text:e.message||"An unknown error occurred."})}},E=async e=>{try{if((await c().fire({title:"Are you sure?",text:"Do you want to delete this class?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"})).isConfirmed){let t=await fetch("".concat(l.Z,"/api/classes/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to delete class")}c().fire({icon:"success",title:"Class Deleted",text:"The class was deleted successfully!"}),y()}}catch(e){c().fire({icon:"error",title:"Error Deleting Class",text:e.message||"An unknown error occurred."})}};return d?(0,a.jsx)("p",{children:"Loading..."}):b&&"headmaster"===b.role?(0,a.jsxs)("div",{className:"container mx-auto py-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Class Management"}),(0,a.jsxs)("form",{onSubmit:p?j:N,className:"mb-6",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"className",className:"block text-sm font-medium",children:"Class Name"}),(0,a.jsx)("input",{type:"text",id:"className",name:"className",value:e,onChange:e=>t(e.target.value),className:"mt-1 px-4 py-2 border rounded w-full",placeholder:"Enter class name"})]}),(0,a.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:p?"Update Class":"Create Class"}),p&&(0,a.jsx)("button",{type:"button",onClick:()=>{x(!1),t(""),g(null)},className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 ml-2",children:"Cancel"})]}),h&&(0,a.jsx)("p",{className:"text-red-500",children:h}),(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"All Classes"}),(0,a.jsxs)("table",{className:"min-w-full border-collapse border border-gray-200",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"border px-4 py-2",children:"Class Name"}),(0,a.jsx)("th",{className:"border px-4 py-2",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:s.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"border px-4 py-2",children:e.className}),(0,a.jsxs)("td",{className:"border px-4 py-2",children:[(0,a.jsx)("button",{onClick:()=>C(e.id,e.className),className:"bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 mr-2","aria-label":"Edit class ".concat(e.className),children:"Edit"}),(0,a.jsx)("button",{onClick:()=>E(e.id),className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600","aria-label":"Delete class ".concat(e.className),children:"Delete"})]})]},e.id))})]})]}):(0,a.jsx)("p",{children:"You do not have permission to access this page."})}}},function(e){e.O(0,[166,888,774,179],function(){return e(e.s=9989)}),_N_E=e.O()}]);