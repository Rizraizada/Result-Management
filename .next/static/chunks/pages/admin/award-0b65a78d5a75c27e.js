(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[606],{2846:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/award",function(){return s(4135)}])},4135:function(e,t,s){"use strict";s.r(t);var a=s(5893),l=s(7294),r=s(2497),n=s(1163),d=s(7730);t.default=()=>{let[e,t]=(0,l.useState)([]),[s,i]=(0,l.useState)(null),[o,c]=(0,l.useState)(null),[m,u]=(0,l.useState)(null),[x,h]=(0,l.useState)(!1),[b,p]=(0,l.useState)(null),[w,g]=(0,l.useState)({title:"",subtitle:""}),[f,j]=(0,l.useState)(""),[N,v]=(0,l.useState)(1),[y]=(0,l.useState)(5),{user:S}=(0,l.useContext)(d.S),C=(0,n.useRouter)();(0,l.useEffect)(()=>{S?"headmaster"!==S.role&&C.push("/unauthorized"):C.push("/login")},[S]),(0,l.useEffect)(()=>{S&&"headmaster"===S.role&&E()},[S]);let E=async()=>{try{let e=await fetch("".concat(r.Z,"/api/award/awards")),s=await e.json();t(s)}catch(e){console.error("Error fetching awards:",e),i({type:"error",text:"Failed to fetch awards"})}},k=e=>{let{name:t,value:s}=e.target;g(e=>({...e,[t]:s}))},_=async e=>{if(e.preventDefault(),!o&&!x){i({type:"error",text:"Please select an image"});return}let t=new FormData;t.append("title",w.title),t.append("subtitle",w.subtitle),o&&t.append("image",o),x&&t.append("id",b);try{let e=await fetch("".concat(r.Z,"/api/award/awards"),{method:x?"PUT":"POST",body:t}),s=await e.json();e.ok?(i({type:"success",text:s.message}),E(),T()):i({type:"error",text:s.message})}catch(e){console.error("Error submitting award:",e),i({type:"error",text:"Failed to submit award"})}},A=async e=>{try{let t=await fetch("".concat(r.Z,"/api/award/awards/").concat(e),{method:"DELETE"}),s=await t.json();t.ok?(i({type:"success",text:s.message}),E()):i({type:"error",text:s.message})}catch(e){console.error("Error deleting award:",e),i({type:"error",text:"Failed to delete award"})}},L=e=>{h(!0),p(e.id),g({title:e.title,subtitle:e.subtitle}),u(e.image)},T=()=>{g({title:"",subtitle:""}),c(null),u(null),h(!1),p(null)},P=e.filter(e=>e.title.toLowerCase().includes(f.toLowerCase())||e.subtitle.toLowerCase().includes(f.toLowerCase())),D=N*y,F=D-y,O=P.slice(F,D),U=e=>v(e);return S&&"headmaster"===S.role&&(0,a.jsxs)("div",{className:"max-w-[900px] mx-auto mt-8",children:[(0,a.jsxs)("div",{className:"bg-white p-6 shadow-lg rounded-lg mb-6",children:[(0,a.jsx)("h3",{className:"text-2xl font-semibold text-slate-800 mb-4 text-center",children:"Add / Edit Award"}),(0,a.jsxs)("form",{onSubmit:_,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Title"}),(0,a.jsx)("input",{type:"text",name:"title",value:w.title,onChange:k,className:"w-full p-3 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-slate-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Subtitle"}),(0,a.jsx)("input",{type:"text",name:"subtitle",value:w.subtitle,onChange:k,className:"w-full p-3 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-slate-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Image"}),(0,a.jsx)("input",{type:"file",onChange:e=>{let t=e.target.files[0];c(t),u(URL.createObjectURL(t))},className:"w-full p-3 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-slate-500"}),m&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("img",{src:m,alt:"Image preview",className:"w-32 h-32 object-cover rounded-md mx-auto"})})]}),s&&(0,a.jsx)("div",{className:"mb-4 p-2 text-sm text-white ".concat("success"===s.type?"bg-green-500":"bg-red-500"),children:s.text}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("button",{type:"submit",className:"px-6 py-3 bg-slate-800 text-white rounded-md hover:bg-slate-700 transition duration-300",children:x?"Update Award":"Add Award"})})]})]}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-slate-800",children:"Awards"}),(0,a.jsx)("p",{className:"text-slate-500",children:"Manage your award list."})]}),(0,a.jsx)("div",{className:"w-[200px]",children:(0,a.jsx)("input",{className:"w-full p-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-slate-500",placeholder:"Search awards...",value:f,onChange:e=>{j(e.target.value)}})})]})}),(0,a.jsxs)("div",{className:"overflow-x-auto bg-white p-6 shadow-lg rounded-lg",children:[(0,a.jsxs)("table",{className:"w-full text-left table-auto",children:[(0,a.jsx)("thead",{className:"bg-slate-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-4 border-b border-slate-200 text-sm font-medium text-slate-500",children:"Title"}),(0,a.jsx)("th",{className:"p-4 border-b border-slate-200 text-sm font-medium text-slate-500",children:"Subtitle"}),(0,a.jsx)("th",{className:"p-4 border-b border-slate-200 text-sm font-medium text-slate-500",children:"Image"}),(0,a.jsx)("th",{className:"p-4 border-b border-slate-200 text-sm font-medium text-slate-500",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:O.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-slate-50 border-b border-slate-200",children:[(0,a.jsx)("td",{className:"p-4 py-5 text-sm text-slate-800 font-semibold",children:e.title}),(0,a.jsx)("td",{className:"p-4 py-5 text-sm text-slate-500",children:e.subtitle}),(0,a.jsx)("td",{className:"p-4 py-5",children:(0,a.jsx)("img",{src:e.image,alt:"Award",className:"w-16 h-16 object-cover rounded-md"})}),(0,a.jsxs)("td",{className:"p-4 py-5",children:[(0,a.jsx)("button",{onClick:()=>L(e),className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>A(e.id),className:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 ml-2",children:"Delete"})]})]},e.id))})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center px-4 py-3 mt-4",children:[(0,a.jsxs)("div",{className:"text-sm text-slate-500",children:["Showing ",(0,a.jsxs)("b",{children:[F+1,"-",Math.min(D,P.length)]})," of"," ",P.length]}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("button",{onClick:()=>U(N-1),disabled:1===N,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal text-slate-500 bg-white border border-slate-200 rounded hover:bg-slate-50 hover:border-slate-400 transition duration-200 ease",children:"Prev"}),Array.from({length:Math.ceil(P.length/y)},(e,t)=>(0,a.jsx)("button",{onClick:()=>U(t+1),className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal ".concat(N===t+1?"text-white bg-slate-800 border-slate-800 hover:bg-slate-600 hover:border-slate-600":"text-slate-500 bg-white border-slate-200 hover:bg-slate-50 hover:border-slate-400"," rounded transition duration-200 ease"),children:t+1},t)),(0,a.jsx)("button",{onClick:()=>U(N+1),disabled:N*y>=P.length,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal text-slate-500 bg-white border border-slate-200 rounded hover:bg-slate-50 hover:border-slate-400 transition duration-200 ease",children:"Next"})]})]})]})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=2846)}),_N_E=e.O()}]);