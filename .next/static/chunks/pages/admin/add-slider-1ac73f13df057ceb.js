(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[709],{5729:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/add-slider",function(){return r(2450)}])},2450:function(e,t,r){"use strict";r.r(t);var s=r(5893),a=r(7294),l=r(2497);r(5120);var d=r(1163),i=r(7730);t.default=()=>{let[e,t]=(0,a.useState)([]),[r,o]=(0,a.useState)(null),[c,n]=(0,a.useState)(null),[m,x]=(0,a.useState)(null),[g,h]=(0,a.useState)(!1),[u,p]=(0,a.useState)(null),{user:b}=(0,a.useContext)(i.S),y=(0,d.useRouter)();(0,a.useEffect)(()=>{b?"headmaster"!==b.role&&y.push("/unauthorized"):y.push("/login")},[b]),(0,a.useEffect)(()=>{b&&"headmaster"===b.role&&f()},[b]);let f=async()=>{try{let e=await fetch("".concat(l.Z,"/api/slider/sliders")),r=(await e.json()).map(e=>({id:e.id,image:"".concat(l.Z).concat(e.image)}));t(r)}catch(e){console.error("Error fetching slider images:",e),o({type:"error",text:"Failed to fetch slider images"})}},j=async e=>{if(e.preventDefault(),!c){o({type:"error",text:"Please select an image to upload"});return}let t=new FormData;t.append("image",c);try{let e=await fetch("".concat(l.Z,"/api/slider/sliders"),{method:"POST",body:t}),r=await e.json();e.ok?(o({type:"success",text:r.message}),f(),n(null),x(null)):o({type:"error",text:r.message})}catch(e){console.error("Error uploading slider image:",e),o({type:"error",text:"Failed to upload slider image"})}},w=async()=>{if(!c||null===u){o({type:"error",text:"Please select an image to update"});return}let e=new FormData;e.append("image",c),e.append("id",u);try{let t=await fetch("".concat(l.Z,"/api/slider/sliders"),{method:"PUT",body:e}),r=await t.json();t.ok?(o({type:"success",text:r.message}),f(),n(null),x(null),h(!1),p(null)):o({type:"error",text:r.message})}catch(e){console.error("Error updating slider image:",e),o({type:"error",text:"Failed to update slider image"})}},N=async e=>{try{let t=await fetch("".concat(l.Z,"/api/slider/sliders/").concat(e),{method:"DELETE"}),r=await t.json();t.ok?(o({type:"success",text:r.message}),f()):o({type:"error",text:r.message})}catch(e){console.error("Error deleting slider image:",e),o({type:"error",text:"Failed to delete slider image"})}};return b&&"headmaster"===b.role&&(0,s.jsx)("div",{className:"flex-1 mx-12",children:(0,s.jsxs)("div",{className:"container max-w-5xl",children:[r&&(0,s.jsx)("div",{className:"p-4 mb-6 font-medium rounded-lg ".concat("error"===r.type?"bg-red-200 text-red-800":"bg-green-200 text-green-800"),children:r.text}),(0,s.jsxs)("div",{className:"grid gap-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-gray-200 bg-gray-50",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:g?"Edit Slider Image":"Add New Slider Image"}),(0,s.jsx)("p",{className:"text-gray-500",children:g?"Update the selected slider image":"Upload a new image to the slider"})]}),(0,s.jsxs)("div",{className:"p-6 flex flex-col items-center gap-4",children:[(0,s.jsxs)("label",{className:"w-full max-w-sm h-52 border-2 border-dashed border-gray-300 rounded-md cursor-pointer flex items-center justify-center transition-colors hover:border-gray-400",children:[(0,s.jsxs)("div",{className:"text-center text-gray-400",children:[(0,s.jsx)("svg",{className:"w-8 h-8 mx-auto",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4m4-5l5-5 5 5m-5-5v12"})}),(0,s.jsx)("span",{children:"Click to upload image"})]}),(0,s.jsx)("input",{type:"file",className:"hidden",onChange:e=>{let t=e.target.files[0];n(t),x(URL.createObjectURL(t))},accept:"image/*"})]}),m&&(0,s.jsx)("div",{className:"w-full max-w-sm rounded-md overflow-hidden",children:(0,s.jsx)("img",{src:m,alt:"Preview",className:"w-full h-52 object-cover"})}),(0,s.jsx)("button",{className:"w-full max-w-sm bg-blue-500 text-white font-semibold py-2 px-4 rounded-md hover:bg-blue-600 transition",onClick:g?w:j,children:g?"Update Image":"Add Image"})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-gray-200 bg-gray-50",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Slider Images"}),(0,s.jsx)("p",{className:"text-gray-500",children:"Manage your existing slider images"})]}),(0,s.jsx)("div",{className:"p-6 overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full border-collapse",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"p-4 bg-gray-50 border-b text-left text-gray-800 font-semibold",children:"Image ID"}),(0,s.jsx)("th",{className:"p-4 bg-gray-50 border-b text-left text-gray-800 font-semibold",children:"Preview"}),(0,s.jsx)("th",{className:"p-4 bg-gray-50 border-b text-left text-gray-800 font-semibold",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsxs)("td",{className:"p-4",children:["#",e.id]}),(0,s.jsx)("td",{className:"p-4",children:(0,s.jsx)("img",{alt:"Slider ".concat(e.id),src:e.image,className:"w-40 h-24 object-cover rounded"})}),(0,s.jsxs)("td",{className:"p-4 flex space-x-4",children:[(0,s.jsx)("button",{className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",onClick:()=>{h(!0),p(e.id),x(e.image)},children:"Edit"}),(0,s.jsx)("button",{className:"px-4 py-2 bg-red-200 text-red-800 rounded hover:bg-red-300",onClick:()=>N(e.id),children:"Delete"})]})]},e.id))})]})})]})]})]})})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=5729)}),_N_E=e.O()}]);