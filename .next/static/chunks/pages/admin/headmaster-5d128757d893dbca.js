(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[391],{5784:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/headmaster",function(){return l(9391)}])},9391:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return h}});var r=l(5893),n=l(7294),s=l(1163),o=l(7730),i=l(2497),a=l(117);l(904),a.Zx.register({family:"Anek Bangla",src:"/fonts/AnekBangla-Regular.ttf"});let c=a.mM.create({page:{padding:30,backgroundColor:"#ffffff",fontFamily:"Anek Bangla"},headerContainer:{flexDirection:"row",marginBottom:20,borderBottom:1,borderBottomColor:"#000000",paddingBottom:10,alignItems:"center"},logoSection:{width:100,height:100,marginRight:10,justifyContent:"center"},logo:{width:90,height:90},centerContent:{flex:1,textAlign:"center",justifyContent:"center"},schoolName:{fontSize:24,marginBottom:5,textAlign:"center"},establishedYear:{fontSize:10,marginBottom:3,textAlign:"center"},addressText:{fontSize:10,marginBottom:3,textAlign:"center"},contactContainer:{flexDirection:"row",justifyContent:"center",marginVertical:2},contactText:{fontSize:10,textAlign:"center",marginHorizontal:5},rightSection:{width:100,justifyContent:"center",border:1,borderColor:"#000000",padding:5,borderRadius:2},codeText:{fontSize:10,textAlign:"right"},reportTitle:{fontSize:16,textAlign:"center",marginBottom:15,fontWeight:"bold"},table:{width:"100%",borderWidth:1,borderColor:"#000000",marginTop:10,marginBottom:20,borderStyle:"solid"},tableRow:{flexDirection:"row",minHeight:25,borderBottomWidth:1,borderBottomColor:"#000000",borderStyle:"solid",alignItems:"stretch"},serialCell:{width:"7%",borderRightWidth:1,borderRightColor:"#000000",justifyContent:"center",alignItems:"center",fontSize:8},classCell:{width:"8%",borderRightWidth:1,borderRightColor:"#000000",justifyContent:"center",alignItems:"center",fontSize:8},sectionCell:{width:"7%",borderRightWidth:1,borderRightColor:"#000000",justifyContent:"center",alignItems:"center",fontSize:8},studentGroupCell:{width:"20%",borderRightWidth:1,borderRightColor:"#000000"},totalStudentsCell:{width:"10%",borderRightWidth:1,borderRightColor:"#000000",justifyContent:"center",alignItems:"center",fontSize:8},presentGroupCell:{width:"16%",borderRightWidth:1,borderRightColor:"#000000"},subGroupCell:{flex:1,borderRightWidth:1,borderRightColor:"#000000",justifyContent:"center",alignItems:"center",fontSize:8,padding:2},totalPresentCell:{width:"10%",borderRightWidth:1,borderRightColor:"#000000",justifyContent:"center",alignItems:"center",fontSize:8},absentCell:{width:"10%",borderRightWidth:1,borderRightColor:"#000000",justifyContent:"center",alignItems:"center",fontSize:8},percentageCell:{width:"8%",justifyContent:"center",alignItems:"center",fontSize:8},headerText:{fontSize:8,textAlign:"center"},cellContent:{padding:2,textAlign:"center"},signatureSection:{flexDirection:"row",justifyContent:"space-between",marginTop:50,paddingHorizontal:50},signatureLine:{borderTopWidth:1,borderTopColor:"#000000",width:150,textAlign:"center",paddingTop:5,fontSize:10}}),d=e=>{let{attendanceData:t=sampleData,date:l}=e;return(0,r.jsx)(a.BB,{children:(0,r.jsxs)(a.T3,{style:c.page,children:[(0,r.jsxs)(a.G7,{style:c.headerContainer,children:[(0,r.jsx)(a.G7,{style:c.logoSection,children:(0,r.jsx)(a.Ee,{src:"/bhs-logo.png",style:c.logo})}),(0,r.jsxs)(a.G7,{style:c.centerContent,children:[(0,r.jsx)(a.xv,{style:c.schoolName,children:"ভরাসার বহুমুখী উচ্চ বিদ্যালয়"}),(0,r.jsxs)(a.xv,{style:c.establishedYear,children:["প্রতিষ্ঠিত: ","১৯২৬"]}),(0,r.jsx)(a.xv,{style:c.addressText,children:"ডাকঘর: সদর ইছাপুরা, উপজেলা: বুড়িচং, জেলা: কুমিল্লা"}),(0,r.jsxs)(a.G7,{style:c.contactContainer,children:[(0,r.jsxs)(a.xv,{style:c.contactText,children:["ইমেইল: ","bharasarhs1926@gmail.com"]}),(0,r.jsxs)(a.xv,{style:c.contactText,children:["মোবাইল: ","01309105256"]})]}),(0,r.jsxs)(a.G7,{style:c.contactContainer,children:[(0,r.jsxs)(a.xv,{style:c.contactText,children:["EIIN: ","১০৫২৫৬"]}),(0,r.jsxs)(a.xv,{style:c.contactText,children:["অধ্যক্ষের মোবাইল: ","01719801505"]})]})]}),(0,r.jsx)(a.G7,{style:c.rightSection,children:(0,r.jsxs)(a.xv,{style:c.codeText,children:["কোড: ","৮০৩৬"]})})]}),(0,r.jsxs)(a.xv,{style:c.reportTitle,children:["দৈনিক হাজিরা রিপোর্ট - ",l]}),(0,r.jsxs)(a.G7,{style:c.table,children:[(0,r.jsxs)(a.G7,{style:c.tableRow,children:[(0,r.jsx)(a.G7,{style:c.serialCell,children:(0,r.jsx)(a.xv,{style:c.headerText,children:"Serial"})}),(0,r.jsx)(a.G7,{style:c.classCell,children:(0,r.jsx)(a.xv,{style:c.headerText,children:"শ্রেণি"})}),(0,r.jsx)(a.G7,{style:c.sectionCell,children:(0,r.jsx)(a.xv,{style:c.headerText,children:"শাখা"})}),(0,r.jsxs)(a.G7,{style:c.studentGroupCell,children:[(0,r.jsx)(a.xv,{style:c.headerText,children:"মোট ছাত্র/ছাত্রী"}),(0,r.jsxs)(a.G7,{style:{flexDirection:"row",borderTopWidth:1},children:[(0,r.jsx)(a.G7,{style:c.subGroupCell,children:(0,r.jsx)(a.xv,{style:c.headerText,children:"ছাত্র"})}),(0,r.jsx)(a.G7,{style:[c.subGroupCell,{borderRightWidth:0}],children:(0,r.jsx)(a.xv,{style:c.headerText,children:"ছাত্রী"})})]})]}),(0,r.jsx)(a.G7,{style:c.totalStudentsCell,children:(0,r.jsx)(a.xv,{style:c.headerText,children:"মোট শিক্ষার্থী"})}),(0,r.jsxs)(a.G7,{style:c.presentGroupCell,children:[(0,r.jsx)(a.xv,{style:c.headerText,children:"উপস্থিত শিক্ষার্থী"}),(0,r.jsxs)(a.G7,{style:{flexDirection:"row",borderTopWidth:1},children:[(0,r.jsx)(a.G7,{style:c.subGroupCell,children:(0,r.jsx)(a.xv,{style:c.headerText,children:"ছাত্র"})}),(0,r.jsx)(a.G7,{style:[c.subGroupCell,{borderRightWidth:0}],children:(0,r.jsx)(a.xv,{style:c.headerText,children:"ছাত্রী"})})]})]}),(0,r.jsx)(a.G7,{style:c.totalPresentCell,children:(0,r.jsx)(a.xv,{style:c.headerText,children:"মোট উপস্থিত"})}),(0,r.jsx)(a.G7,{style:c.absentCell,children:(0,r.jsx)(a.xv,{style:c.headerText,children:"মোট অনুপস্থিত"})}),(0,r.jsx)(a.G7,{style:c.percentageCell,children:(0,r.jsx)(a.xv,{style:c.headerText,children:"শতকরা হার"})})]}),t.map((e,t)=>(0,r.jsxs)(a.G7,{style:c.tableRow,children:[(0,r.jsx)(a.G7,{style:c.serialCell,children:(0,r.jsx)(a.xv,{style:c.cellContent,children:t+1})}),(0,r.jsx)(a.G7,{style:c.classCell,children:(0,r.jsx)(a.xv,{style:c.cellContent,children:e.className})}),(0,r.jsx)(a.G7,{style:c.sectionCell,children:(0,r.jsx)(a.xv,{style:c.cellContent,children:e.sectionName})}),(0,r.jsx)(a.G7,{style:c.studentGroupCell,children:(0,r.jsxs)(a.G7,{style:{flexDirection:"row"},children:[(0,r.jsx)(a.G7,{style:c.subGroupCell,children:(0,r.jsx)(a.xv,{style:c.cellContent,children:parseInt(e.maleStudents||"100")})}),(0,r.jsx)(a.G7,{style:[c.subGroupCell,{borderRightWidth:0}],children:(0,r.jsx)(a.xv,{style:c.cellContent,children:parseInt(e.femaleStudents||"100")})})]})}),(0,r.jsx)(a.G7,{style:c.totalStudentsCell,children:(0,r.jsx)(a.xv,{style:c.cellContent,children:"N/A"})}),(0,r.jsx)(a.G7,{style:c.presentGroupCell,children:(0,r.jsxs)(a.G7,{style:{flexDirection:"row"},children:[(0,r.jsx)(a.G7,{style:c.subGroupCell,children:(0,r.jsx)(a.xv,{style:c.cellContent,children:parseInt(e.male_count||"0")})}),(0,r.jsx)(a.G7,{style:[c.subGroupCell,{borderRightWidth:0}],children:(0,r.jsx)(a.xv,{style:c.cellContent,children:parseInt(e.female_count||"0")})})]})}),(0,r.jsx)(a.G7,{style:c.totalPresentCell,children:(0,r.jsx)(a.xv,{style:c.cellContent,children:parseInt(e.male_count||"0")+parseInt(e.female_count||"0")})}),(0,r.jsx)(a.G7,{style:c.absentCell,children:(0,r.jsx)(a.xv,{style:c.cellContent,children:parseInt(e.male_count||"0",10)+parseInt(e.female_count||"0",10)-100})}),(0,r.jsx)(a.G7,{style:c.percentageCell,children:(0,r.jsx)(a.xv,{style:c.cellContent,children:(()=>{let t=parseInt(e.maleStudents||"100")+parseInt(e.femaleStudents||"100"),l=parseInt(e.male_count||"0")+parseInt(e.female_count||"0");return t>0?"".concat((l/t*100).toFixed(2),"%"):"0%"})()})})]},t))]}),(0,r.jsxs)(a.G7,{style:c.signatureSection,children:[(0,r.jsx)(a.xv,{style:c.signatureLine,children:"শ্রেণি শিক্ষকের স্বাক্ষর"}),(0,r.jsx)(a.xv,{style:c.signatureLine,children:"প্রধান শিক্ষকের স্বাক্ষর"})]})]})})};var h=()=>{let{user:e}=(0,n.useContext)(o.S),t=(0,s.useRouter)(),[l,c]=(0,n.useState)([]),[h,x]=(0,n.useState)([]),[u,j]=(0,n.useState)([]),[g,p]=(0,n.useState)(""),[m,y]=(0,n.useState)(""),[b,f]=(0,n.useState)(""),[C,v]=(0,n.useState)(""),[G,S]=(0,n.useState)(""),[w,N]=(0,n.useState)(null),[T,R]=(0,n.useState)(!1);(0,n.useEffect)(()=>{e?"headmaster"!==e.role?t.push("/unauthorized"):(_(),I(),W()):t.push("/login")},[e]);let _=async()=>{try{let e=await fetch("".concat(i.Z,"/api/sections")),t=await e.json();c(t)}catch(e){console.error("Error fetching sections:",e)}},I=async()=>{try{let e=await fetch("".concat(i.Z,"/api/auth/users")),t=await e.json();x(t.users||[])}catch(e){console.error("Error fetching users:",e)}},W=async()=>{try{let e=await fetch("".concat(i.Z,"/api/classes")),t=await e.json();j(t)}catch(e){console.error("Error fetching classes:",e)}},z=async e=>{e.preventDefault(),R(!0);let t=[];C&&G&&t.push("startDate=".concat(C),"endDate=".concat(G)),g&&t.push("sectionId=".concat(g)),m&&t.push("classId=".concat(m)),b&&t.push("teacherId=".concat(b));try{let e=await fetch("".concat(i.Z,"/api/quickattendance/report?").concat(t.join("&"))),l=await e.json();Array.isArray(l.data)?N(l.data):N([])}catch(e){console.error("Error fetching attendance report:",e),N([])}finally{R(!1)}};return e&&"headmaster"===e.role?(0,r.jsxs)("div",{className:"container mx-auto p-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Report Wizard"}),(0,r.jsxs)("form",{onSubmit:z,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row",children:[(0,r.jsx)("input",{type:"date",value:C,onChange:e=>v(e.target.value),className:"p-2 border rounded flex-1"}),(0,r.jsx)("input",{type:"date",value:G,onChange:e=>S(e.target.value),className:"p-2 border rounded flex-1"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,r.jsxs)("select",{value:g,onChange:e=>p(e.target.value),className:"p-2 border rounded",children:[(0,r.jsx)("option",{value:"",children:"Select Section"}),l.map(e=>(0,r.jsx)("option",{value:e.id,children:e.sectionName},e.id))]}),(0,r.jsxs)("select",{value:m,onChange:e=>y(e.target.value),className:"p-2 border rounded",children:[(0,r.jsx)("option",{value:"",children:"Select Class"}),u.map(e=>(0,r.jsx)("option",{value:e.id,children:e.className},e.id))]}),(0,r.jsxs)("select",{value:b,onChange:e=>f(e.target.value),className:"p-2 border rounded",children:[(0,r.jsx)("option",{value:"",children:"Select Teacher"}),h.map(e=>(0,r.jsx)("option",{value:e.id,children:e.full_name},e.id))]})]}),(0,r.jsx)("button",{type:"submit",className:"w-full sm:w-auto bg-blue-500 text-white p-2 rounded hover:bg-blue-600 transition-colors",disabled:T,children:T?"Loading...":"Generate Attendance Report"})]}),w&&0!==w.length?(0,r.jsx)(a.WD,{document:(0,r.jsx)(d,{attendanceData:w,date:new Date().toLocaleDateString("bn-BD")}),fileName:"attendance_report_".concat(C,"_").concat(G,".pdf"),className:"bg-blue-500 text-white p-2 rounded hover:bg-blue-600 transition-colors",children:e=>{let{loading:t}=e;return t?"Generating PDF...":"Download PDF"}}):null,(null==w?void 0:w.length)>0&&(0,r.jsx)("div",{className:"mt-8 overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full border-collapse border border-gray-200",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-100",children:[(0,r.jsx)("th",{className:"border p-2",children:"Teacher"}),(0,r.jsx)("th",{className:"border p-2",children:"Class"}),(0,r.jsx)("th",{className:"border p-2",children:"Section"}),(0,r.jsx)("th",{className:"border p-2",children:"Total Students"}),(0,r.jsx)("th",{className:"border p-2",children:"Present Male"}),(0,r.jsx)("th",{className:"border p-2",children:"Present Female"}),(0,r.jsx)("th",{className:"border p-2",children:"Attendance %"})]})}),(0,r.jsx)("tbody",{children:w.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"border p-2 text-center",children:e.teacher_name}),(0,r.jsx)("td",{className:"border p-2 text-center",children:e.className}),(0,r.jsx)("td",{className:"border p-2 text-center",children:e.sectionName}),(0,r.jsx)("td",{className:"border p-2 text-center",children:e.male_count+e.female_count}),(0,r.jsx)("td",{className:"border p-2 text-center",children:e.male_count}),(0,r.jsx)("td",{className:"border p-2 text-center",children:e.female_count}),(0,r.jsxs)("td",{className:"border p-2 text-center",children:[e.percentage,"%"]})]},t))})]})})]}):null}},2480:function(){}},function(e){e.O(0,[439,111,191,208,876,515,888,774,179],function(){return e(e.s=5784)}),_N_E=e.O()}]);